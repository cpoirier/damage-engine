{"assets":{"461176109662CCA2B9FEE4AE59F09810":{"type":"texture","index":62,"assetRequest":{"type":"slide","state":"outgoing","slide":"C2AB956A-BA51-493A-86F8-A55B29B3CE2C"},"url":"assets/461176109662CCA2B9FEE4AE59F09810.svg","width":1024,"height":768},"56F424949ACC023EEBAEB4277590EA28":{"type":"texture","index":63,"assetRequest":{"type":"slide","state":"incoming","slide":"8832CBD6-44B7-4431-814D-978126320555"},"url":"assets/56F424949ACC023EEBAEB4277590EA28.svg","width":1024,"height":768}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":true,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.0004922987690640373,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":15,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"56F424949ACC023EEBAEB4277590EA28"},{"animations":[{"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","duration":0.01,"to":{"scalar":true}}],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"461176109662CCA2B9FEE4AE59F09810"}]}]},"effects":[],"duration":0.01,"type":"transition","name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"  class GameLocationManager extends GameSubsystem","targetRectangle":{"y":213.5,"x":106.08837890625,"width":295.0048828125,"height":11}},{"text":"  {","targetRectangle":{"y":224.5,"x":106.08837890625,"width":18.0615234375,"height":11}},{"text":"  //===============================================================================================","targetRectangle":{"y":246.5,"x":106.08837890625,"width":596.0302734375,"height":11}},{"text":"  // SECTION: Location.recent_players DataHandler definitions","targetRectangle":{"y":257.5,"x":106.08837890625,"width":367.2509765625,"height":11}},{"text":"    function handle_location_build_recent_players_handler( $name, $location, $ds )","targetRectangle":{"y":279.5,"x":106.08837890625,"width":493.681640625,"height":11}},{"text":"    {","targetRectangle":{"y":290.5,"x":106.08837890625,"width":30.1025390625,"height":11}},{"text":"      $details = array","targetRectangle":{"y":301.5,"x":106.08837890625,"width":132.451171875,"height":11}},{"text":"      (","targetRectangle":{"y":312.5,"x":106.08837890625,"width":42.1435546875,"height":11}},{"text":"          \"type\"     => \"list\"","targetRectangle":{"y":323.5,"x":106.08837890625,"width":180.615234375,"height":11}},{"text":"        , \"max_age\"  => $this->get_parameter(\"LOCATION_RECENT_PLAYERS_MAX_AGE\", 5 * ONE_MINUTE)","targetRectangle":{"y":334.5,"x":106.08837890625,"width":571.9482421875,"height":11}},{"text":"        , \"criteria\" => \"location_id = {location_id} and timestamp >= now() - interval 30 minute\"","targetRectangle":{"y":345.5,"x":106.08837890625,"width":583.9892578125,"height":11}},{"text":"      );","targetRectangle":{"y":356.5,"x":106.08837890625,"width":48.1640625,"height":11}},{"text":"      return $location->build_handler_from_table($name, \"UserInvestigateLog\", $details, $this->get_ds($ds));","targetRectangle":{"y":367.5,"x":106.08837890625,"width":650.21484375,"height":11}},{"text":"    }","targetRectangle":{"y":378.5,"x":106.08837890625,"width":30.1025390625,"height":11}},{"text":"    ","targetRectangle":{"y":389.5,"x":106.08837890625,"width":24.08203125,"height":11}},{"text":"    function filter_location_recent_players_query( $query, $schema, $ds )","targetRectangle":{"y":400.5,"x":106.08837890625,"width":439.4970703125,"height":11}},{"text":"    {","targetRectangle":{"y":411.5,"x":106.08837890625,"width":30.1025390625,"height":11}},{"text":"      $user = $schema->get_base_query(\"User\")->project(\"user_id\", \"username\");","targetRectangle":{"y":422.5,"x":106.08837890625,"width":469.599609375,"height":11}},{"text":"      $up   = $schema->get_base_query(\"UserProfile\")->project(\"user_id\", \"avatar\", \"avatar_id\");","targetRectangle":{"y":433.5,"x":106.08837890625,"width":577.96875,"height":11}},{"text":"      ","targetRectangle":{"y":444.5,"x":106.08837890625,"width":36.123046875,"height":11}},{"text":"      return $query->join_on($user, \"user_id\")->join_on($up, \"user_id\")","targetRectangle":{"y":455.5,"x":106.08837890625,"width":427.4560546875,"height":11}},{"text":"        ->order_by(\"timestamp\", -1)","targetRectangle":{"y":466.5,"x":106.08837890625,"width":210.7177734375,"height":11}},{"text":"        ->limit(15)","targetRectangle":{"y":477.5,"x":106.08837890625,"width":114.3896484375,"height":11}},{"text":"      ;","targetRectangle":{"y":488.5,"x":106.08837890625,"width":42.1435546875,"height":11}},{"text":"    }","targetRectangle":{"y":499.5,"x":106.08837890625,"width":30.1025390625,"height":11}},{"text":"  }","targetRectangle":{"y":543.5,"x":106.08837890625,"width":18.0615234375,"height":11}},{"text":"Given a Location GameObject called $location, accessing $location->recent_players for the first time will transparently cause GameObject to dispatch “location_build_recent_players_handler”to obtain a DataHandler to load and manage the collection; at the end of the process, the collection is in memory and processing resumes","targetRectangle":{"y":52,"x":483.142578125,"width":335.78125,"height":112}},{"text":"By using GameObject’s build_handler_from_table() routine, we can filter the produced query before it is passed to the DataHandler. This filter is global, so you can filter another subsystem’s DataHandler queries, too (though, you should be very careful when doing that). ","targetRectangle":{"y":381.5,"x":639.93359375,"width":342.0224609375,"height":80}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":true,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.0004922987690640373,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":15,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"461176109662CCA2B9FEE4AE59F09810"}]}]}}]}